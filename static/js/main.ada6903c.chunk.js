(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){},17:function(e,t,a){e.exports=a(34)},26:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),c=a.n(l),s=(a(26),a(14)),m=a(1);a(10);var o=()=>r.a.createElement("header",{className:"main-header"},r.a.createElement("h1",{className:"title"},"FreeRooms"),r.a.createElement("p",{className:"subtitle"},"\u0412\u0441\u0435 \u0434\u0432\u0435\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u044b"));var u=()=>r.a.createElement("footer",{className:"footer"});var i=e=>{let{username:t,setUsername:a,room:l,setRoom:c,socket:s,rooms:m,createRoom:i}=e;const[E,p]=Object(n.useState)(""),[d,g]=Object(n.useState)(""),[v,h]=Object(n.useState)(""),f=m.filter(e=>e.toLowerCase().includes(v.toLowerCase()));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"side-panel left"}),r.a.createElement(o,null),r.a.createElement("div",{className:"side-panel right"}),r.a.createElement("main",{className:"main-content"},r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:e=>e.preventDefault(),className:"form-box"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Nickname:"),r.a.createElement("input",{id:"username",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f...",value:t,onChange:e=>{e.target.value.length<=20?(g(""),a(e.target.value)):g("\u0418\u043c\u044f \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0442\u044c 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")},className:d?"error-input":""}),d&&r.a.createElement("p",{className:"error"},d)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"room"},"\u0412\u044b\u0431\u043e\u0440 \u043a\u043e\u043c\u043d\u0430\u0442\u044b:"),r.a.createElement("input",{type:"text",placeholder:"\u041f\u043e\u0438\u0441\u043a \u043a\u043e\u043c\u043d\u0430\u0442\u044b...",value:v,onChange:e=>h(e.target.value)}),r.a.createElement("select",{id:"room",value:l,onChange:e=>c(e.target.value)},r.a.createElement("option",{value:""},"-\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u043d\u0430\u0442-"),f.map(e=>r.a.createElement("option",{key:e,value:e},e)))),r.a.createElement("div",{className:"create-room"},r.a.createElement("label",null,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u043e\u043c\u043d\u0430\u0442\u0443"),r.a.createElement("div",{className:"create-room-row"},r.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",value:E,onChange:e=>p(e.target.value)}),r.a.createElement("button",{type:"button",onClick:()=>{""!==E.trim()?(i(E),p("")):alert("\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))),r.a.createElement("button",{className:"start-btn",type:"button",onClick:()=>{t.length>20?g("\u0418\u043c\u044f \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0442\u044c 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):""!==l&&""!==t&&s.emit("check_username",{username:t,room:l},async e=>{let n=t;if(e){let a=1;const r=async e=>new Promise(t=>{s.emit("check_username",{username:e,room:l},t)});for(;e;)n=`${t}#${a}`,e=await r(n),a++}a(n),s.emit("join_room",{username:n,room:l}),window.location.href="/chat"})}},"\u041d\u0430\u0447\u0430\u0442\u044c \u043e\u0431\u0449\u0435\u043d\u0438\u0435")))),r.a.createElement(u,null))};var E=e=>{let{socket:t,username:a,room:l}=e;const[c,s]=Object(n.useState)([]),[m,i]=Object(n.useState)(""),E=Object(n.useRef)(null),p=e=>{s(t=>[...t,e])},d=e=>{s(e)};Object(n.useEffect)(()=>(t.on("receive_message",p),t.on("last_100_messages",d),()=>{t.off("receive_message",p),t.off("last_100_messages",d)}),[t]),Object(n.useEffect)(()=>{E.current&&E.current.scrollIntoView({behavior:"smooth"})},[c]);const g=()=>{const e=m.trim();e&&(t.emit("send_message",{username:a,room:l,message:e}),i(""))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"side-panel left"}),r.a.createElement(o,null),r.a.createElement("div",{className:"side-panel right"}),r.a.createElement("main",{className:"main-content"},r.a.createElement("div",{className:"chat-container"},r.a.createElement("h2",{className:"room-title"},l),r.a.createElement("section",{className:"messages"},c.map((e,t)=>r.a.createElement("div",{key:t,className:`message ${e.username===a?"sent":"received"}`},r.a.createElement("div",{className:"message-content"},r.a.createElement("span",{className:"username"},e.username,": "),r.a.createElement("span",{className:"text"},e.message)),r.a.createElement("span",{className:"time"},(e=>new Date(e).toLocaleString("ru-RU"))(e.created_at||e.__createdtime__)))),r.a.createElement("div",{ref:E})),r.a.createElement("section",{className:"input-area"},r.a.createElement("input",{value:m,onChange:e=>i(e.target.value),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",onKeyPress:e=>{"Enter"===e.key&&g()}}),r.a.createElement("button",{onClick:g},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))),r.a.createElement(u,null))};const p=a(16).a.connect("http://localhost:4000");var d=function(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)(""),[c,o]=Object(n.useState)([]);Object(n.useEffect)(()=>{p.emit("get_rooms",e=>{o(e)})},[]);const u=e=>{p.emit("create_room",e,t=>{t.success?(o(t=>[...t,e]),alert(t.message)):alert(t.message)})};return r.a.createElement(s.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",render:()=>r.a.createElement(i,{username:e,setUsername:t,room:a,setRoom:l,socket:p,rooms:c,createRoom:u})}),r.a.createElement(m.a,{path:"/chat",render:()=>r.a.createElement(E,{username:e,room:a,socket:p})}))))};var g=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,35)).then(t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:c}=t;a(e),n(e),r(e),l(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d,null))),g()}},[[17,1,2]]]);
//# sourceMappingURL=main.ada6903c.chunk.js.map